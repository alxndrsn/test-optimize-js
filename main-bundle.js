(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
function testScriptLoadTimeIteration(e){return new Promise(function(t){window.onDone=function(){var e=marky.stop("script_"+r);Object.keys(window).forEach(function(e){n[e]||delete window[e]}),t(e.duration)};var n={};Object.keys(window).forEach(function(e){n[e]=!0});var r=btoa(Math.random().toString());e+=";onDone();/* "+r+" */";var o=document.createElement("script");o.textContent=e,marky.mark("script_"+r),document.body.appendChild(o)})}function getIterations(){var e=parseInt(iterationsInput.value);return e<=0&&(e=1),e}function testScriptLoadTime(e){function t(){return testScriptLoadTimeIteration(e).then(function(e){o.push(e)})}for(var n=getIterations(),r=Promise.resolve(),o=[],i=0;i<n;i++)r=r.then(t);return r.then(function(){var e=median(o);return{median:e,iterations:n}})}function testScript(){goButton.disabled=!0,outputPre.innerText="Testing...";var e=inputTextarea.value;requestAnimationFrame(function(){worker.postMessage(e).then(function(t){return testScriptLoadTime(e).then(function(e){return testScriptLoadTime(t).then(function(t){outputPre.textContent="Median of "+e.iterations+" iterations:\nWithout optimize-js : "+e.median.toFixed(2)+" ms\nWith optimize-js    : "+t.median.toFixed(2)+" ms",goButton.disabled=!1})})}).catch(function(e){outputPre.textContent=e.message+"\n"+e.stack,goButton.disabled=!1})})}var marky=require(4),PromiseWorker=require(6),worker=new PromiseWorker(new Worker("worker-bundle.js")),median=require(5),fetch=window.fetch||require(7),Promise=window.Promise||require(3),STARTING_SCRIPT="/* Paste your JS here! */\n!function() {\n  console.log('hello world')\n}()",$=document.querySelector.bind(document),inputTextarea=$("#textarea_input"),goButton=$("#button_go"),outputPre=$("#pre_display"),iterationsInput=$("#input_iterations"),commonLibsSelect=$("#select_common_libs");window.performance&&window.performance.setResourceTimingBufferSize&&window.performance.setResourceTimingBufferSize(1e5),commonLibsSelect.addEventListener("change",function(e){var t=e.target.value;return e.target.value?(outputPre.innerText="Testing...",void fetch(t).then(function(e){return e.text()}).then(function(e){inputTextarea.value=e,testScript()})):(inputTextarea.value=STARTING_SCRIPT,void(outputPre.textContent=""))}),inputTextarea.value=STARTING_SCRIPT,goButton.addEventListener("click",function(){return testScript()});

},{"3":3,"4":4,"5":5,"6":6,"7":7}],2:[function(require,module,exports){
(function (global){
"use strict";function nextTick(){draining=!0;for(var e,n,t=queue.length;t;){for(n=queue,queue=[],e=-1;++e<t;)n[e]();t=queue.length}draining=!1}function immediate(e){1!==queue.push(e)||draining||scheduleDrain()}var Mutation=global.MutationObserver||global.WebKitMutationObserver,scheduleDrain;if(Mutation){var called=0,observer=new Mutation(nextTick),element=global.document.createTextNode("");observer.observe(element,{characterData:!0}),scheduleDrain=function(){element.data=called=++called%2}}else if(global.setImmediate||"undefined"==typeof global.MessageChannel)scheduleDrain="document"in global&&"onreadystatechange"in global.document.createElement("script")?function(){var e=global.document.createElement("script");e.onreadystatechange=function(){nextTick(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},global.document.documentElement.appendChild(e)}:function(){setTimeout(nextTick,0)};else{var channel=new global.MessageChannel;channel.port1.onmessage=nextTick,scheduleDrain=function(){channel.port2.postMessage(0)}}var draining,queue=[];module.exports=immediate;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],3:[function(require,module,exports){
"use strict";function INTERNAL(){}function Promise(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=PENDING,this.queue=[],this.outcome=void 0,e!==INTERNAL&&safelyResolveThenable(this,e)}function QueueItem(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function unwrap(e,t,r){immediate(function(){var n;try{n=t(r)}catch(t){return handlers.reject(e,t)}n===e?handlers.reject(e,new TypeError("Cannot resolve promise with itself")):handlers.resolve(e,n)})}function getThen(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function safelyResolveThenable(e,t){function r(t){i||(i=!0,handlers.reject(e,t))}function n(t){i||(i=!0,handlers.resolve(e,t))}function o(){t(n,r)}var i=!1,s=tryCatch(o);"error"===s.status&&r(s.value)}function tryCatch(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}function resolve(e){return e instanceof this?e:handlers.resolve(new this(INTERNAL),e)}function reject(e){var t=new this(INTERNAL);return handlers.reject(t,e)}function all(e){function t(e,t){function u(e){i[t]=e,++s!==n||o||(o=!0,handlers.resolve(l,i))}r.resolve(e).then(u,function(e){o||(o=!0,handlers.reject(l,e))})}var r=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,o=!1;if(!n)return this.resolve([]);for(var i=new Array(n),s=0,u=-1,l=new this(INTERNAL);++u<n;)t(e[u],u);return l}function race(e){function t(e){r.resolve(e).then(function(e){o||(o=!0,handlers.resolve(s,e))},function(e){o||(o=!0,handlers.reject(s,e))})}var r=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,o=!1;if(!n)return this.resolve([]);for(var i=-1,s=new this(INTERNAL);++i<n;)t(e[i]);return s}var immediate=require(2),handlers={},REJECTED=["REJECTED"],FULFILLED=["FULFILLED"],PENDING=["PENDING"];module.exports=Promise,Promise.prototype.catch=function(e){return this.then(null,e)},Promise.prototype.then=function(e,t){if("function"!=typeof e&&this.state===FULFILLED||"function"!=typeof t&&this.state===REJECTED)return this;var r=new this.constructor(INTERNAL);if(this.state!==PENDING){var n=this.state===FULFILLED?e:t;unwrap(r,n,this.outcome)}else this.queue.push(new QueueItem(r,e,t));return r},QueueItem.prototype.callFulfilled=function(e){handlers.resolve(this.promise,e)},QueueItem.prototype.otherCallFulfilled=function(e){unwrap(this.promise,this.onFulfilled,e)},QueueItem.prototype.callRejected=function(e){handlers.reject(this.promise,e)},QueueItem.prototype.otherCallRejected=function(e){unwrap(this.promise,this.onRejected,e)},handlers.resolve=function(e,t){var r=tryCatch(getThen,t);if("error"===r.status)return handlers.reject(e,r.value);var n=r.value;if(n)safelyResolveThenable(e,n);else{e.state=FULFILLED,e.outcome=t;for(var o=-1,i=e.queue.length;++o<i;)e.queue[o].callFulfilled(t)}return e},handlers.reject=function(e,t){e.state=REJECTED,e.outcome=t;for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callRejected(t);return e},Promise.resolve=resolve,Promise.reject=reject,Promise.all=all,Promise.race=race;

},{"2":2}],4:[function(require,module,exports){
"use strict";function throwIfEmpty(r){if(!r)throw new Error("name must be non-empty")}function insertSorted(r,e){for(var t,n=0,o=r.length;n<o;)t=n+o>>>1,r[t].startTime<e.startTime?n=t+1:o=t;r.splice(n,0,e)}Object.defineProperty(exports,"__esModule",{value:!0});var perf="undefined"!=typeof performance&&performance,now=perf&&perf.now?function(){return perf.now()}:function(){return Date.now()};if(perf&&perf.mark&&perf.measure)exports.mark=function(r){throwIfEmpty(r),perf.mark("start "+r)},exports.stop=function(r){throwIfEmpty(r),perf.mark("end "+r),perf.measure(r,"start "+r,"end "+r);var e=perf.getEntriesByName(r);return e[e.length-1]},exports.getEntries=function(){return perf.getEntriesByType("measure")};else{var marks={},entries=[];exports.mark=function(r){throwIfEmpty(r);var e=now();marks["$"+r]=e},exports.stop=function(r){throwIfEmpty(r);var e=now(),t=marks["$"+r];if(!t)throw new Error("no known mark: "+r);var n={startTime:t,name:r,duration:e-t,entryType:"measure"};return insertSorted(entries,n),n},exports.getEntries=function(){return entries}}

},{}],5:[function(require,module,exports){
!function(){function r(r){if(!Array.isArray(r))throw new TypeError("You need to pass an Array not "+typeof r);if(1==r.length)return r[0];r.sort(function(r,e){return r-e});var e=Math.floor(r.length/2);return r.length%2?r[e]:(r[e-1]+r[e])/2}"undefined"!=typeof module&&module.exports?module.exports=r:window.median=r}();

},{}],6:[function(require,module,exports){
"use strict";function parseJsonSafely(e){try{return JSON.parse(e)}catch(e){return!1}}function onMessage(e,r){var s=parseJsonSafely(r.data);if(s){var o=s[0],n=s[1],a=s[2],t=e._callbacks[o];t&&(delete e._callbacks[o],t(n,a))}}function PromiseWorker(e){var r=this;r._worker=e,r._callbacks={},e.addEventListener("message",function(e){onMessage(r,e)})}var MyPromise="undefined"!=typeof Promise?Promise:require(3),messageIds=0;PromiseWorker.prototype.postMessage=function(e){var r=this,s=messageIds++,o=[s,e];return new MyPromise(function(e,n){r._callbacks[s]=function(r,s){return r?n(new Error(r.message)):void e(s)};var a=JSON.stringify(o);if("undefined"!=typeof r._worker.controller){var t=new MessageChannel;t.port1.onmessage=function(e){onMessage(r,e)},r._worker.controller.postMessage(a,[t.port2])}else r._worker.postMessage(a)})},module.exports=PromiseWorker;
},{"3":3}],7:[function(require,module,exports){
module.exports="function"==typeof fetch?fetch:function(e,t){return t=t||{},new Promise(function(n,r){function s(){var e,t=[],n=[],r={};return o.getAllResponseHeaders().replace(/^(.*?):\s*([\s\S]*?)$/gm,function(s,o,u){t.push(o=o.toLowerCase()),n.push([o,u]),e=r[o],r[o]=e?e+","+u:u}),{ok:1==(o.status/200|0),status:o.status,statusText:o.statusText,url:o.responseURL,clone:s,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},xml:function(){return Promise.resolve(o.responseXML)},blob:function(){return Promise.resolve(new Blob([o.response]))},headers:{keys:function(){return t},entries:function(){return n},get:function(e){return r[e.toLowerCase()]},has:function(e){return e.toLowerCase()in r}}}}var o=new XMLHttpRequest;o.open(t.method||"get",e);for(var u in t.headers)o.setRequestHeader(u,t.headers[u]);o.withCredentials="omit"!=t.credentials,o.onload=function(){n(s())},o.onerror=r,o.send(t.body)})};

},{}]},{},[1]);
